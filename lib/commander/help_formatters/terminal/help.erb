<% unless @default_command.nil? -%>
  <% default_command = @commands.values.find { |command| command.name == @default_command.to_s } -%>
<% end -%>
  <%= $terminal.color "NAME", :bold %>:

    <%= program :name %>

  <%= $terminal.color "DESCRIPTION", :bold %>:

    <%= Commander::HelpFormatter.indent 4, program(:description) %>

  <%= "%s: %s" % [$terminal.color("COMMANDS", :bold), default_command.nil? ? '' : '(* default)'] %>
<% for name, command in @commands.sort -%>
	<% unless alias? name %>
    <% summary_prefix = (!default_command.nil? && command.name == default_command.name)? '* ' : '  ' -%>
    <%= "%-#{max_command_length}s #{summary_prefix}%s" % [command.name, command.summary || command.description] -%>
	<% end -%>
<% end %>
<% unless @aliases.empty? %>
  <%= $terminal.color "ALIASES", :bold %>:
  <% for alias_name, args in @aliases.sort %>
    <%= "%-#{max_aliases_length}s %s %s" % [alias_name, command(alias_name).name, args.join(' ')] -%>
  <% end %>
<% end %>
<% unless @options.empty? -%>
  <%= $terminal.color "GLOBAL OPTIONS", :bold %>:
	<% for option in @options -%>

    <%= option[:switches].join ', ' %> 
        <%= option[:description] %>
	<% end -%>
<% end -%>
<% unless default_command.nil? || default_command.options.empty? %>
  <%= $terminal.color "OPTIONS for #{default_command.name}", :bold %>:
	<% for option in default_command.options -%>

    <%= option[:switches].join ', ' %> 
        <%= option[:description] %>
	<% end -%>
<% end -%>
<% if program :help -%>
  <% for title, body in program(:help) %>
  <%= $terminal.color title.to_s.upcase, :bold %>:

    <%= body %>
  <% end -%>
<% end -%>

